<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Order books</title>
<script type="text/javascript" src="js/jQuery.js"></script>
<style>
#checked{
display:none;
}</style>
</head>
<body>

	<form method="post" action="createorder" onsubmit="return chk()">
		<label for="prodname">Product Name: </label> <input type="text"
			id="prodname" name="prodname"> <span id="nsms"></span><br> 
			<input type="button" id="check" value="check" onclick="return nchk()">
			<div id="checked">
			<label
			for="prodrate">Product Rate: </label> <input type="text" readonly
			id="prodrate" name="prodrate"> <br>
			
			 <label for="prodqty">Product
			Quantity: </label> <input type="number" id="prodqty" name="prodqty">
		<span id="qsms"></span>
		
		 <input type="hidden" readonly id="oprodqty"
			name="oprodqty"> <input type="hidden" readonly id="prodid"
			name="prodid"> <br> <input type="submit" value="order">
			</div>
	</form>
	<script type="text/javascript">
		function chk() {
			errorQty = validQty();
			if (errorQty) {
				return true;
			} else {
				return false;
			}
		}
		function validQty() {
			prodqty = parseInt(document.getElementById("prodqty").value);
			oprodqty = parseInt(document.getElementById("oprodqty").value);
			if (prodqty > 0) {
				if (oprodqty >= prodqty) {
					document.getElementById("qsms").innerHTML = "";
					return true;
				}
				else {
					document.getElementById("qsms").innerHTML = "Not available";
					return false;
				}
			}
			else{
				document.getElementById("qsms").innerHTML = "Quantity cannet be less than 1";
				return false;
			}
		}

		$(document).ready(function() {
			// 	alert();
// 			$("#prodname").blur(function() {
			$("#check").click(function() {
				$("#checked").css("display","block");
				
			
				// alert();
				$.ajax({
					url : "getproduct",
					type : "POST",
					dataType : "JSON",
					data : {
						prodname : $("#prodname").val()
					},
					success : function(res) {
						console.log(res);

						//  console.log(res);
						$("#prodrate").val(res[0].prodrate);
						$("#oprodqty").val(res[0].prodqty);
						$("#prodid").val(res[0].prodid);

					}
				})
			})

		})
	</script>
</body>
</html>